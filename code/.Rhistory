View(familias.unicas)
View(familias.unicas)
install.packages("readxl")
library("readxl")
my_data <- read_excel(".../hotel_bookings_miss.xlsx")
install.packages("readxl")
library("readxl")
my_data <- read_excel("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx")
library("readxl")
my_data <- read_excel("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx")
my_data <- read_excel("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx", header=TRUE, stringsAsFactors = FALSE)
install.packages("xlsx")
library("xlsx")
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx", header=TRUE, stringsAsFactors = FALSE)
library("xlsx")
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
view(my_data)
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
view(my_data)
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(my_data)
View(my_data)
hotel_bookings_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
library("xlsx")
hotel_bookings_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
hotel_bookings_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
gc()
hotel_bookings_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
library("xlsx")
hotel_bookings_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
hotel_bookings_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
hotel_bookings_data <- read.xlsx2("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(hotel_bookings_data)
options(java.parameters = "-Xmx8000m")
hotel_bookings_data <- read.xlsx2("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(my_data)
options(Java.parameters = "-Xmx8000m")
jgc <- function()
{
.jcall("Java/lang/System", method = "gc")
}
gc()
jgc()
jgc()
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(my_data)
library("xlsx")
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(my_data)
options(Java.parameters = "-Xmx8000m")
my_data <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
View(my_data)
gc()
.jcall("Java/lang/System", method = "gc")
options(Java.parameters = "-Xmx8000m")
gc()
install.packages("openxlsx", dependencies = TRUE)
hotel_bookings <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
library(openxlsx)
hotel_bookings <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1, header=TRUE, stringsAsFactors = FALSE)
library(openxlsx)
hotel_bookings <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1)
library(openxlsx)
hotel_bookings <- read.xlsx("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/hotel_bookings_miss.xlsx",1)
View(hotel_bookings)
names(hotel_bookings)
str(hotel_bookings)
summary(hotel_bookings)
hotel_bookings.clear <- na.omit(hotel_bookings)
View(hotel_bookings.clear)
View(hotel_bookings.clear)
library(ggplot2)
library(scales)
boxplot(hotel_bookings.clear$lead_time, col = "gray", main = "Especies de iris\nsegún la anchura del sépalo")
boxplot(hotel_bookings.clear$lead_time, col = "gray", main = "Lead time")
outliersReplace <- function(data, highLimit){
data[data > highLimit] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear, 400)
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time, 400)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(x,c(0.07,0.93))
data[data < quantile[1]] <- mean(data)
data[data > quantile[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time, 400)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.07,0.93))
data[data < quantile[1]] <- mean(data)
data[data > quantile[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.07,0.93))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.10,0.90))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
boxplot(hotel_bookings.clear$lead_time, main = "Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = "Con reemplazo de outliers con R")
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$lead_time, main = "Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = "Con reemplazo de outliers con R")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.7,0.93))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$lead_time, main = "Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = "Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = "Con reemplazo de outliers con R")
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$lead_time, main = "Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = "Con reemplazo de outliers con R")
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.07,0.93))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.06,0.94))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.08,0.92))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
outliersReplace <- function(data){
quantiles <- quantile(data,c(0.04,0.96))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data     #devolvemos el dato
}
hotel_bookings.clear2 <- outliersReplace(hotel_bookings.clear$lead_time)
boxplot(hotel_bookings.clear2, col = "gray", main = "Lead time2")
boxplot(hotel_bookings.clear$lead_time, main = "lead_time Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = " lead_time Con reemplazo de outliers con R")
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$lead_time, main = "lead_time Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear2, main = " lead_time Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$arrival_date_year, col = "gray", main = "Lead time")
boxplot(hotel_bookings.clear$arrival_date_month, col = "gray", main = "Lead time")
boxplot(hotel_bookings.clear$arrival_date_week_number, col = "gray", main = "Lead time")
boxplot(hotel_bookings.clear$arrival_date_day_of_month, col = "gray", main = "Lead time")
boxplot(hotel_bookings.clear$stays_in_weekend_nights, col = "gray", main = "Lead time")
boxplot(hotel_bookings.clear$stays_in_weekend_nights, col = "gray", main = "Lead time")
boxplot(hotel_bookings.clear$stays_in_weekend_nights, main = "stays_in_weekend_nights Sin reemplazo de outliers con R")
boxplot(hotel_bookings.stays_in_weekend_nights, main = " stays_in_weekend_nights Con reemplazo de outliers con R")
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$stays_in_weekend_nights, main = "stays_in_weekend_nights Sin reemplazo de outliers con R")
boxplot(hotel_bookings.stays_in_weekend_nights, main = " stays_in_weekend_nights Con reemplazo de outliers con R")
hotel_bookings.stays_in_weekend_nights <- outliersReplace(hotel_bookings.clear$stays_in_weekend_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$stays_in_weekend_nights, main = "stays_in_weekend_nights Sin reemplazo de outliers con R")
boxplot(hotel_bookings.stays_in_weekend_nights, main = " stays_in_weekend_nights Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$stays_in_week_nights, main = "stays_in_week_nights Sin reemplazo de outliers con R")
stays_in_week_nights <- outliersReplace(hotel_bookings.clear$stays_in_week_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$stays_in_week_nights, main = "stays_in_week_nights Sin reemplazo de outliers con R")
boxplot(stays_in_week_nights, main = " stays_in_week_nights Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$adults, main = "stays_in_week_nights Sin reemplazo de outliers con R")
adults <- outliersReplace(hotel_bookings.clear$adults)
boxplot(hotel_bookings.clear$adults, main = "adults Sin reemplazo de outliers con R")
boxplot(adults, main = " adults Con reemplazo de outliers con R")
adults <- outliersReplace(hotel_bookings.clear$adults)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$adults, main = "adults Sin reemplazo de outliers con R")
boxplot(adults, main = " adults Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$children, main = "adults Sin reemplazo de outliers con R")
children <- outliersReplace(hotel_bookings.clear$children)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$children, main = "children Sin reemplazo de outliers con R")
boxplot(children, main = " children Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$babies, main = "children Sin reemplazo de outliers con R")
babies <- outliersReplace(hotel_bookings.clear$babies)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$babies, main = "babies Sin reemplazo de outliers con R")
boxplot(babies, main = " babies Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$meal, main = "babies Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear$country, main = "babies Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear$market_segment, main = "babies Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear$distribution_channel, main = "babies Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear$is_repeated_guest, main = "babies Sin reemplazo de outliers con R")
boxplot(hotel_bookings.clear$previous_cancellations, main = "babies Sin reemplazo de outliers con R")
previous_cancellations <- outliersReplace(hotel_bookings.clear$previous_cancellations)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$previous_cancellations, main = "previous_cancellations Sin reemplazo de outliers con R")
boxplot(previous_cancellations, main = " previous_cancellations Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$previous_bookings_not_canceled, main = "previous_cancellations Sin reemplazo de outliers con R")
previous_bookings_not_canceled <- outliersReplace(hotel_bookings.clear$previous_bookings_not_canceled)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$previous_bookings_not_canceled, main = "previous_bookings_not_canceled Sin reemplazo de outliers con R")
boxplot(previous_bookings_not_canceled, main = " previous_bookings_not_canceled Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$booking_changes, main = "previous_bookings_not_canceled Sin reemplazo de outliers con R")
booking_changes <- outliersReplace(hotel_bookings.clear$booking_changes)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$booking_changes, main = "booking_changes Sin reemplazo de outliers con R")
boxplot(booking_changes, main = " booking_changes Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$days_in_waiting_list, main = "booking_changes Sin reemplazo de outliers con R")
#days_in_waiting_list
days_in_waiting_list <- outliersReplace(hotel_bookings.clear$days_in_waiting_list)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$days_in_waiting_list, main = "days_in_waiting_list Sin reemplazo de outliers con R")
boxplot(days_in_waiting_list, main = " days_in_waiting_list Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$adr, main = "days_in_waiting_list Sin reemplazo de outliers con R")
#adr
adr <- outliersReplace(hotel_bookings.clear$adr)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$adr, main = "adr Sin reemplazo de outliers con R")
boxplot(adr, main = " adr Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$required_car_parking_spaces, main = "adr Sin reemplazo de outliers con R")
required_car_parking_spaces <- outliersReplace(hotel_bookings.clear$required_car_parking_spaces)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$required_car_parking_spaces, main = "required_car_parking_spaces Sin reemplazo de outliers con R")
boxplot(required_car_parking_spaces, main = " required_car_parking_spaces Con reemplazo de outliers con R")
total_of_special_requests <- outliersReplace(hotel_bookings.clear$total_of_special_requests)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$total_of_special_requests, main = "total_of_special_requests Sin reemplazo de outliers con R")
boxplot(total_of_special_requests, main = " total_of_special_requests Con reemplazo de outliers con R")
#lead_time
lead_time <- outliersReplace(hotel_bookings.clear$lead_time)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$lead_time, main = "lead_time Sin reemplazo de outliers con R")
boxplot(lead_time, main = " lead_time Con reemplazo de outliers con R")
boxplot(hotel_bookings.clear$stays_in_weekend_nights, col = "gray", main = "Lead time")
lead_time <- outliersReplace(hotel_bookings.clear$lead_time)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$lead_time, main = "lead_time Sin reemplazo de outliers con R")
boxplot(lead_time, main = " lead_time Con reemplazo de outliers con R")
stays_in_weekend_nights <- outliersReplace(hotel_bookings.clear$stays_in_weekend_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$stays_in_weekend_nights, main = "stays_in_weekend_nights Sin reemplazo de outliers con R")
boxplot(hotel_bookings.stays_in_weekend_nights, main = " stays_in_weekend_nights Con reemplazo de outliers con R")
stays_in_week_nights <- outliersReplace(hotel_bookings.clear$stays_in_week_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$stays_in_week_nights, main = "stays_in_week_nights Sin reemplazo de outliers con R")
boxplot(stays_in_week_nights, main = " stays_in_week_nights Con reemplazo de outliers con R")
adults <- outliersReplace(hotel_bookings.clear$adults)
par(mfrow = c(1,2))
boxplot(hotel_bookings.clear$adults, main = "adults Sin reemplazo de outliers con R")
boxplot(adults, main = " adults Con reemplazo de outliers con R")
setwd("C:/Users/USUARIO/Desktop/Programacion/Projectos Git/ea-2021-1-cc51/code")
hotel_bookings <- read.csv("../data/hotel_bookings_miss.csv", header=TRUE, stringsAsFactors=FALSE, sep=";")
#INSPECCIONAR DATOS
#Operaciones para visualizar datos
names(hotel_bookings)
View(hotel_bookings)
str(hotel_bookings)
summary(hotel_bookings)
#FunciÃ³n para calcular los valores NA de cada columna del Dataframe
sin_valor <- function(x) {
sum = 0
for(i in 1:ncol(x)) {
cat("En la columna ", colnames(x[i]), "total de valores en blanco: ", colSums(is.na(x[i])),"\n")
}
}
#FunciÃ³n para calcular los valores en blanco de cada columna del Dataframe
en_blanco <- function(x) {
sum = 0
for(i in 1:ncol(x)) {
cat("En la columna ", colnames(x[i]), "total de valores en blanco: ", colSums(x[i]==""),"\n")
}
}
#Observamos la cantidad de valores NA y en blanco dentro de todo el dataframe
sin_valor(hotel_bookings)
en_blanco(hotel_bookings)
sapply(hotel_bookings,anyNA)
#Realizamos una cuenta de las filas duplicada dentro de todo el dataframe
nrow(hotel_bookings_clear[duplicated(hotel_bookings_clear),])
#PRE-PROCESAMIENTO
library(ggplot2)
hotel_bookings_clear <- na.omit(hotel_bookings)    #Omitimos los valores NA del dataframe
hotel_bookings_clear <- unique(hotel_bookings_clear)           #Nos deshacemos de los valores duplicados
reemplazar_atipicos <- function(data){
quantiles <- quantile(data,c(0.04,0.96))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data
}
reemplazar_atipicos2 <- function(data, max_value, min_value) {
data[data < min_value] <- mean(data)
data[data > max_value] <- median(data)
data
}
#lead_time
lead_time <- reemplazar_atipicos(hotel_bookings_clear$lead_time)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$lead_time, main = "lead_time con valores atípicos")
boxplot(lead_time, main = " lead_time sin valores atípicos")
#boxplot(hotel_bookings_clear$stays_in_weekend_nights, col = "gray", main = "Lead time")
#stays_in_weekend_nights
stays_in_weekend_nights <- reemplazar_atipicos(hotel_bookings_clear$stays_in_weekend_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$stays_in_weekend_nights, main = "stays_in_weekend_nights con valores atípicos")
boxplot(stays_in_weekend_nights, main = " stays_in_weekend_nights sin valores atípicos")
#stays_in_week_nights
stays_in_week_nights <- reemplazar_atipicos(hotel_bookings_clear$stays_in_week_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$stays_in_week_nights, main = "stays_in_week_nights con valores atípicos")
boxplot(stays_in_week_nights, main = " stays_in_week_nights sin valores atípicos")
#adults
adults <- reemplazar_atipicos2(hotel_bookings_clear$adults,10,1)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$adults, main = "adults con valores atípicos")
boxplot(adults, main = " adults sin valores atípicos")
#children
children <- reemplazar_atipicos2(hotel_bookings_clear$children, 3, 0)
par(mfrow = c(1, 2))
boxplot(hotel_bookings_clear$children, main = "children con valores atípicos")
boxplot(children, main = " children sin valores atípicos")
#babies
babies <- reemplazar_atipicos2(hotel_bookings_clear$babies, 3, 0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$babies, main = "babies con valores atípicos")
boxplot(babies, main = " babies sin valores atípicos")
#previous_cancellations
previous_cancellations <-
reemplazar_atipicos2(hotel_bookings_clear$previous_cancellations, 5, 0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$previous_cancellations, main = "previous_cancellations con valores atípicos")
boxplot(previous_cancellations, main = " previous_cancellations sin valores atípicos")
#previous_bookings_not_canceled
previous_bookings_not_canceled <- reemplazar_atipicos(hotel_bookings_clear$previous_bookings_not_canceled)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$previous_bookings_not_canceled, main = "previous_bookings_not_canceled con valores atípicos")
boxplot(previous_bookings_not_canceled, main = " previous_bookings_not_canceled sin valores atípicos")
#booking_changes
booking_changes <-
reemplazar_atipicos(hotel_bookings_clear$booking_changes)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$booking_changes, main = "booking_changes con valores atípicos")
boxplot(booking_changes, main = " booking_changes sin valores atípicos")
#days_in_waiting_list
days_in_waiting_list <-
reemplazar_atipicos2(hotel_bookings_clear$days_in_waiting_list, 60, 0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$days_in_waiting_list, main = "days_in_waiting_list con valores atípicos")
boxplot(days_in_waiting_list, main = " days_in_waiting_list sin valores atípicos")
#adr
adr <- reemplazar_atipicos(hotel_bookings_clear$adr)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$adr, main = "adr con valores atípicos")
boxplot(adr, main = " adr sin valores atípicos")
#required_car_parking_spaces
required_car_parking_spaces <- reemplazar_atipicos2(hotel_bookings_clear$required_car_parking_spaces,3,0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$required_car_parking_spaces, main = "required_car_parking_spaces con valores atípicos")
boxplot(required_car_parking_spaces, main = " required_car_parking_spaces sin valores atípicos")
#total_of_special_requests
total_of_special_requests <- reemplazar_atipicos(hotel_bookings_clear$total_of_special_requests)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$total_of_special_requests, main = "total_of_special_requests con valores atÃ­picos")
boxplot(total_of_special_requests, main = " total_of_special_requests sin valores atÃ­picos")
#CARGAR DATOS
hotel_bookings <- read.csv("../data/hotel_bookings_miss.csv", header=TRUE, stringsAsFactors=FALSE, sep=";")
#INSPECCIONAR DATOS
#Operaciones para visualizar datos
names(hotel_bookings)
View(hotel_bookings)
str(hotel_bookings)
summary(hotel_bookings)
#FunciÃ³n para calcular los valores NA de cada columna del Dataframe
sin_valor <- function(x) {
sum = 0
for(i in 1:ncol(x)) {
cat("En la columna ", colnames(x[i]), "total de valores en blanco: ", colSums(is.na(x[i])),"\n")
}
}
#FunciÃ³n para calcular los valores en blanco de cada columna del Dataframe
en_blanco <- function(x) {
sum = 0
for(i in 1:ncol(x)) {
cat("En la columna ", colnames(x[i]), "total de valores en blanco: ", colSums(x[i]==""),"\n")
}
}
#Observamos la cantidad de valores NA y en blanco dentro de todo el dataframe
sin_valor(hotel_bookings)
en_blanco(hotel_bookings)
sapply(hotel_bookings,anyNA)
#PRE-PROCESAMIENTO
library(ggplot2)
hotel_bookings_clear <- na.omit(hotel_bookings)    #Omitimos los valores NA del dataframe
#Realizamos una cuenta de las filas duplicada dentro de todo el dataframe
nrow(hotel_bookings_clear[duplicated(hotel_bookings_clear),])
hotel_bookings_clear <- unique(hotel_bookings_clear)           #Nos deshacemos de los valores duplicados
reemplazar_atipicos <- function(data){
quantiles <- quantile(data,c(0.04,0.96))
data[data < quantiles[1]] <- mean(data)
data[data > quantiles[2]] <- median(data)
data
}
reemplazar_atipicos2 <- function(data, max_value, min_value) {
data[data < min_value] <- mean(data)
data[data > max_value] <- median(data)
data
}
#lead_time
lead_time <- reemplazar_atipicos(hotel_bookings_clear$lead_time)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$lead_time, main = "lead_time con valores atípicos")
boxplot(lead_time, main = " lead_time sin valores atípicos")
#boxplot(hotel_bookings_clear$stays_in_weekend_nights, col = "gray", main = "Lead time")
#stays_in_weekend_nights
stays_in_weekend_nights <- reemplazar_atipicos(hotel_bookings_clear$stays_in_weekend_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$stays_in_weekend_nights, main = "stays_in_weekend_nights con valores atípicos")
boxplot(stays_in_weekend_nights, main = " stays_in_weekend_nights sin valores atípicos")
#stays_in_week_nights
stays_in_week_nights <- reemplazar_atipicos(hotel_bookings_clear$stays_in_week_nights)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$stays_in_week_nights, main = "stays_in_week_nights con valores atípicos")
boxplot(stays_in_week_nights, main = " stays_in_week_nights sin valores atípicos")
#adults
adults <- reemplazar_atipicos2(hotel_bookings_clear$adults,10,1)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$adults, main = "adults con valores atípicos")
boxplot(adults, main = " adults sin valores atípicos")
#children
children <- reemplazar_atipicos2(hotel_bookings_clear$children, 3, 0)
par(mfrow = c(1, 2))
boxplot(hotel_bookings_clear$children, main = "children con valores atípicos")
boxplot(children, main = " children sin valores atípicos")
#babies
babies <- reemplazar_atipicos2(hotel_bookings_clear$babies, 3, 0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$babies, main = "babies con valores atípicos")
boxplot(babies, main = " babies sin valores atípicos")
#previous_cancellations
previous_cancellations <-
reemplazar_atipicos2(hotel_bookings_clear$previous_cancellations, 5, 0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$previous_cancellations, main = "previous_cancellations con valores atípicos")
boxplot(previous_cancellations, main = " previous_cancellations sin valores atípicos")
#previous_bookings_not_canceled
previous_bookings_not_canceled <- reemplazar_atipicos(hotel_bookings_clear$previous_bookings_not_canceled)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$previous_bookings_not_canceled, main = "previous_bookings_not_canceled con valores atípicos")
boxplot(previous_bookings_not_canceled, main = " previous_bookings_not_canceled sin valores atípicos")
#booking_changes
booking_changes <-
reemplazar_atipicos(hotel_bookings_clear$booking_changes)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$booking_changes, main = "booking_changes con valores atípicos")
boxplot(booking_changes, main = " booking_changes sin valores atípicos")
#days_in_waiting_list
days_in_waiting_list <-
reemplazar_atipicos2(hotel_bookings_clear$days_in_waiting_list, 60, 0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$days_in_waiting_list, main = "days_in_waiting_list con valores atípicos")
boxplot(days_in_waiting_list, main = " days_in_waiting_list sin valores atípicos")
#adr
adr <- reemplazar_atipicos(hotel_bookings_clear$adr)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$adr, main = "adr con valores atípicos")
boxplot(adr, main = " adr sin valores atípicos")
#required_car_parking_spaces
required_car_parking_spaces <- reemplazar_atipicos2(hotel_bookings_clear$required_car_parking_spaces,3,0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$required_car_parking_spaces, main = "required_car_parking_spaces con valores atípicos")
boxplot(required_car_parking_spaces, main = " required_car_parking_spaces sin valores atípicos")
#total_of_special_requests
total_of_special_requests <- reemplazar_atipicos(hotel_bookings_clear$total_of_special_requests)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$total_of_special_requests, main = "total_of_special_requests con valores atÃ­picos")
boxplot(total_of_special_requests, main = " total_of_special_requests sin valores atÃ­picos")
required_car_parking_spaces <- reemplazar_atipicos2(hotel_bookings_clear$required_car_parking_spaces,3,0)
par(mfrow = c(1,2))
boxplot(hotel_bookings_clear$required_car_parking_spaces, main = "required_car_parking_spaces con valores atípicos")
boxplot(required_car_parking_spaces, main = " required_car_parking_spaces sin valores atípicos"
)
